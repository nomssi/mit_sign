<core:View xmlns:layout="sap.ui.layout" xmlns:form="sap.ui.layout.form" 
           xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:core="sap.ui.core" 
           xmlns:C="mit_sign.controls" xmlns:f="sap.ui.layout.form" xmlns:l="sap.ui.layout" 
           controllerName="mit_sign.controller.Sign" xmlns:html="http://www.w3.org/1999/xhtml"
           busy="{pdfView>/busy}" 
		   busyIndicatorDelay="{pdfView>/delay}">
	<NavContainer id="wizardNavContainer">
		<pages>
			<Page id="wizardContentPage" showHeader="true" title="{i18n>signTitle}  {Vbeln}">
				<landmarkInfo>
					<PageAccessibleLandmarkInfo
							rootRole="Region" rootLabel="{i18n>Checkout_rootLabel}"
							contentRole="Main" contentLabel="{i18n>Checkout_summaryContentLabel}"
							footerRole="Banner" footerLabel="{i18n>Checkout_footerLabel}"/>
				</landmarkInfo>				
				<headerContent>
					<Button id="homeButton" type="Emphasized" text="{i18n>homeButtonText}" press=".onBack"/>
					<Button id="settingsButton" type="Emphasized" text="{i18n>settingsButtonText}" press=".onSettingsButtonPress"/>
				</headerContent>
				<content>
					<Wizard id="signWizard" complete="onSigningCompleted"
					        finishButtonText="{i18n>checkoutWizardReviewbtn}">
						<steps>
							<WizardStep id="contentStep" 
							            nextStep="signReleaserStep" 
							            icon="sap-icon://detail-view" 
							            complete="onCompleteContent" validated="true" 
							            title="{i18n>contentTitle} {VBELN}">
			    			<MessageStrip class="sapUiSmallMarginBottom"
										text="{i18n>strip.Review}"
										showIcon="true"/>									
								<Table id="lDelPos" inset="false" alternateRowColors="true" 
								       noDataText="{i18n>homeNoData}" busyIndicatorDelay="0" 
								      items="{EventPositions}" class="sapUiForceWidthAuto sapUiResponsiveMargin">
									<headerToolbar>
									</headerToolbar>
									<columns>
										<Column minScreenWidth="Tablet"
										        demandPopin="true">
											<Text text="{i18n>lbl.item}" />
										</Column>
										<Column width="auto">
											<Text text="{i18n>lbl.Material}" />
										</Column>
										<Column>
											<Text text="{i18n>lbl.Shorttext}" />
										</Column>
										<Column>
											<Text text="{i18n>lbl.Quantity}" />
										</Column>
									</columns>

									<items>
										<ColumnListItem>
											<cells>
												<Text
												    text="{Posnr}" />
												<Text
													text="{Matnr}"/>
												<ObjectIdentifier
                                                    title="{Maktx}"/>
												<ObjectNumber
													number="{ path:'Lfimg', formatter:'.formatter.float'}"
													unit="{Meins}" />													
											</cells>
										</ColumnListItem>
									</items>
								</Table>
							</WizardStep>
							
							<WizardStep id="signReleaserStep" nextStep="signReceiverStep" title="{i18n>SignPad1Title}" icon="sap-icon://signature" 
							            validated="false" >
			    			<MessageStrip class="sapUiSmallMarginBottom"
										text="{i18n>strip.ReleaseStorage}"
										showIcon="true"/>									
								<f:SimpleForm id="FormSignReleaser" editable="true" layout="ResponsiveGridLayout" title="{i18n>SignPad1Title}"
								              labelSpanL="2" labelSpanM="4" columnsL="1" columnsM="1" adjustLabelSpan="true">
								<f:content>			
									<Label text="{i18n>lbl.Signer}" required="true">
                                		<layoutData>
											<layout:GridData span="L2 M2" />
										</layoutData>
									</Label>
                                  <Input id="sName" value="{ path: 'SignerName',
                                                             type: 'sap.ui.model.type.String' }" 
                                         change="onInputChange" placeholder="{{i18n>placeholder.Signer}">
                                		<layoutData>
											<layout:GridData span="L8 M8" />
										</layoutData>
								  </Input>

	                              <Label text="{i18n>lbl.Signature}">
                                		<layoutData>
											<layout:GridData span="L2 M2" linebreak="true" />
										</layoutData>
	                              </Label>	                              
     								<C:SignPad id="signature-pad" value="{SignatureReleaser}" 
     								                change="onSignChange" 
     								                bgColor="#d6f5ff" width="800px"/>
                                	<Button icon="sap-icon://reset" text="{i18n>Clear}" press="onClearButton" type="Transparent" id="btnClear">
                                		<layoutData>
											<layout:GridData span="L2 M2" />
										</layoutData>
                                	</Button>     								
								</f:content>
	 							</f:SimpleForm> 
							</WizardStep>							
								
							<WizardStep id="signReceiverStep" nextStep="showPDFStep" title="{i18n>SignPad2Title}" icon="sap-icon://signature" 
							            validated="false" complete="onCompleteSignReceiverStep">
			    			<MessageStrip class="sapUiSmallMarginBottom" text="{i18n>strip.ReleaseReceiver}" showIcon="true"/>									
								<f:SimpleForm id="FormSignReceiver" editable="true" layout="ResponsiveGridLayout" title="{i18n>SignPad2Title}"
								              labelSpanL="2" labelSpanM="4" columnsL="1" columnsM="1" adjustLabelSpan="true">
								<f:content>
									<Label text="{i18n>lbl.Receiver}" required="true">
                                		<layoutData>
											<layout:GridData span="L2 M2" />
										</layoutData>
									</Label>
                                  <Input id="sRecvName" value="{ path: 'ReceiverName',
                                                                 type: 'sap.ui.model.type.String' }"
                                         change="onInputChange" placeholder="{{i18n>placeholder.Receiver}">                                  
                                		<layoutData>
											<layout:GridData span="L8 M8" />
										</layoutData>
								  </Input>
								  
								<Label text="{i18n>lbl.Signature2}">
                                		<layoutData>
											<layout:GridData span="L2 M2" linebreak="true" />
										</layoutData>
	                              </Label>
									<C:SignPad id="signature-pad2" value="{SignatureReceiver}" change="onSignChange" bgColor="#d6f5ff" width="800px"/>
                                	<Button icon="sap-icon://reset" text="{i18n>Clear}" press="onClearButton" type="Transparent" id="btnClear2">
                                		<layoutData>
											<layout:GridData span="L2 M2" />
										</layoutData>
                                	</Button>
                                	
								</f:content>
	 							</f:SimpleForm> 
							</WizardStep>										

						<WizardStep id="showPDFStep" activate="onSignCommit" validated="false" title="{i18n>lastViewTitle}" icon="sap-icon://complete">
						<MessageStrip class="sapUiSmallMarginBottom" text="{i18n>strip.Finish}" showIcon="true"/>										
							<ScrollContainer height="100%" width="100%" horizontal="true" vertical="true">
									<FlexBox direction="Column" renderType="Div" class="sapUiSmallMargin">
									<SegmentedButton selectedButton="btnCorrect">
											<Button icon="sap-icon://accept" text="{i18n>pdf.Correct}" press="onSigningCompleted" id="btnCorrect"/>
											<Button icon="sap-icon://error" text="{i18n>pdf.Incorrect}" press="onSigningFailed" id="btnIncorrect"/>
									</SegmentedButton>										
	                                    <PDFViewer source="{PDFUrl}" title="{/Title}" height="600px" id="PDF" displayType="Embedded" >											
											<layoutData>
												<FlexItemData growFactor="1"/>
											</layoutData>
										</PDFViewer>
									</FlexBox>
								</ScrollContainer>
						</WizardStep>
						
						</steps>
					</Wizard>
				</content>
				<footer>
					<Bar id="wizardFooterBar" visible="{= ${message>/}.length === 0 ? false : true}">
						<contentLeft>
							<Button id="showPopoverButton" icon="sap-icon://message-popup" type="Emphasized" 
							        text="{= ${message>/}.length }"
							        press=".handleMessagePopoverPress"/>
						</contentLeft>
					</Bar>
				</footer>
			</Page>

		</pages>
	</NavContainer>
</core:View>